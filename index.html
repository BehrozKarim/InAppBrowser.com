<head>
    <meta name="viewport" content="user-scalable=no, width=device-width">
    <meta charset="utf-8">
    <title>hijacking.report</title>
</head>
<h1>hijacking.report</h1>
<p id="author">via <a href="https://twitter.com/KrauseFx">@KrauseFx</a></p>
<p>Verify the app's browser is not injecting any JavaScript code</p>

<hr />

<div id="website-status-container">
    <span id="website-status">‚úÖ</span>
    <span id="website-url">
        <script type="text/javascript">
            document.write(window.location.href)
        </script>
    </span>
</div>

<ol id="resultsList">
    <h3>Detected JavaScript Events:</h3>
    <p id="none">None</p>
</ol>

<div id="summary">
    Good news, it looks like the host application doesn't inject or run any JavaScript code.
</div>

<footer>
    <hr />
    <p>For full details on what this website is doing visit the <a target="_blank" href="https://krausefx.com/blog/hijacking-report">hijacking.report announcement</a></p>
    <p>For more privacy & security projects visit <a target="_blank" href="https://krausefx.com/privacy">krausefx.com/privacy</a></p>
</footer>

<script type="text/javascript">
    const resultsList = document.getElementById("resultsList")
    const noneElement = document.getElementById("none")
    const websiteStatus = document.getElementById("website-status")
    const summary = document.getElementById("summary")

    function appendEvent(str) {
        noneElement.style.display = "none"
        websiteStatus.innerHTML = "üö®"
        resultsList.innerHTML += "<li>" + str + "</li>"
        summary.innerHTML = "‚ùå JavaScript injection detected! See the list of events above!"
    }

    const originalCreateElement = document.createElement
    document.createElement = function(a) {
        appendEvent("document.createElement (\"" + a + "\") ")
        let fakeresultsListponse = originalCreateElement.apply(this, arguments)
        Object.defineProperty(fakeresultsListponse, "src", {
            set: function(value) {
                appendEvent("FakeScriptObj.src = <br />\"" + value + "\"")
                bar = value;
            }
        });
        return fakeresultsListponse
    }
    const originalGetElementById = document.getElementById
    document.getElementById = function(a, b) {
        appendEvent("document.getElementById(\"" + a + "\")")
        return originalGetElementById.apply(this, arguments);
    }

    const originalGetElementByTagName = document.getElementsByTagName
    document.getElementsByTagName = function(a, b) {
        appendEvent("document.getElementsByTagName(\"" + a + "\") ")
        const objects = originalGetElementByTagName.apply(this, arguments)

        const handler3 = {
            get(target, prop, receiver) {
                const parameters = arguments;
                appendEvent("&nbsp;&nbsp;TagObjectArr[x].parentNode." + prop + "")
                return target[prop]
            }
        }
        const handler2 = {
            get(target, prop, receiver) {
                appendEvent("&nbsp;&nbsp;TagObjectArr[x]." + prop + "")
                if (prop == "parentNode") {
                    return new Proxy(target[prop], handler3)
                }
                return target[prop]
            }
        }
        let fakeObjects = []
        for (let i = 0; i < objects.length; i++) {
            fakeObjects.push(new Proxy(objects[i], handler2))
        }

        const handler1 = {
            get(target, prop, receiver) {
                if (Math.abs(parseInt(prop)) > 0 || prop == "0") {
                    appendEvent("&nbsp;&nbsp;TagObjectArr[" + prop + "]")
                } else {
                    appendEvent("&nbsp;&nbsp;TagObjectArr." + prop + "")
                }
                return target[prop]
            }
        }

        return new Proxy(fakeObjects, handler1);
    }

    setTimeout(function() {
        resultsList.style.display = 'block';
    }, 100);
</script>

<style type="text/css">
    * {
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";
        color: #353535;
    }
    
    body {
        background-color: #f0f0f0;
        margin: 40px;
    }
    
    h1 {
        font-size: 1.5em;
    }
    
    ol {
        border: 1px solid #ccc;
        padding-left: 35px;
        padding-right: 35px;
        padding-top: 15px;
        padding-bottom: 10px;
    }
    
    a {
        color: #0085bd !important;
    }
    
    #resultsList {
        display: none;
    }
    
    #resultsList h3 {
        margin-top: 10px;
        padding-top: 0px;
    }
    
    ol>li {
        margin-bottom: 0.5em;
    }
    
    #author {
        margin-top: -10px;
    }
    
    footer {
        margin-top: 40px;
    }
    
    footer a {
        text-decoration: none;
    }
    
    footer p {
        margin-top: 0px;
        margin-bottom: 5px;
    }
    
    #website-status {
        font-size: 50px;
        font-weight: bold;
        color: #00ff00;
        padding: 10px;
    }
    
    #website-url {
        font-size: 30px;
    }
    
    hr {
        border: 0;
        height: 1px;
        background-image: linear-gradient(to right, rgba(0, 0, 0, 0), rgba(40, 40, 40, 0.3), rgba(0, 0, 0, 0));
        margin-bottom: 35px;
        background-color: transparent !important;
    }
</style>