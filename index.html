<head>
    <meta name="viewport" content="user-scalable=no, width=device-width">
</head>
<h1>Instagram Tracking Proof</h1>
<h5>via <a href="https://twitter.com/KrauseFx">@KrauseFx</a></h5>
<p>for more privacy projects visit <a href="https://krausefx.com/privacy">krausefx.com/privacy</a></p>

<ol id="res"></ol>

<script type="text/javascript">
    const res = document.getElementById("res")

    const originalCreateElement = document.createElement
    document.createElement = function(a) {
        res.innerHTML += "<li>document.createElement (\"" + a + "\") </li>"
        let fakeResponse = originalCreateElement.apply(this, arguments)
        Object.defineProperty(fakeResponse, "src", {
            set: function(value) {
                res.innerHTML += "<li>FakeScriptObj.src = <br />\"" + value + "\"</li>"
                bar = value;
            }
        });
        return fakeResponse
    }
    const originalGetElementById = document.getElementById
    document.getElementById = function(a, b) {
        res.innerHTML += "<li>document.getElementById(\"" + a + "\")</li>"
        return originalGetElementById.apply(this, arguments);
    }

    const originalGetElementByTagName = document.getElementsByTagName
    document.getElementsByTagName = function(a, b) {
        res.innerHTML += "<li>document.getElementsByTagName(\"" + a + "\") </li>"
        const objects = originalGetElementByTagName.apply(this, arguments)

        const handler3 = {
            get(target, prop, receiver) {
                const parameters = arguments;
                res.innerHTML += "<li>&nbsp;&nbsp;TagObjectArr[x].parentNode." + prop + "(\"" + parameters + "\")</li>"
                return target[prop]
            },
            apply: function(target, thisArg, args) {
                res.innerHTML += "<li>&nbsp;&nbsp;TagObjectArr[x].parentNode." + target.name + "(\"" + args + "\")</li>"
            },
            set: function(target, prop, value, receiver) {
                res.innerHTML += "<li>&nbsp;&nbsp;TagObjectArr[x].parentNode." + prop + " = " + value + "</li>"
            }
        }
        const handler2 = {
            get(target, prop, receiver) {
                res.innerHTML += "<li>&nbsp;&nbsp;TagObjectArr[x]." + prop + "</li>"
                if (prop == "parentNode") {
                    return new Proxy(target[prop], handler3)
                }
                return target[prop]
            }
        }
        let fakeObjects = []
        for (let i = 0; i < objects.length; i++) {
            fakeObjects.push(new Proxy(objects[i], handler2))
        }

        const handler1 = {
            get(target, prop, receiver) {
                if (Math.abs(parseInt(prop)) > 0 || prop == "0") {
                    res.innerHTML += "<li>&nbsp;&nbsp;TagObjectArr[" + prop + "]</li>"
                } else {
                    res.innerHTML += "<li>&nbsp;&nbsp;TagObjectArr." + prop + "</li>"
                }
                return target[prop]
            }
        }

        return new Proxy(fakeObjects, handler1);
    }
</script>

<style type="text/css">
    body {
        background-color: #f0f0f0;
        font-family: sans-serif;
    }
    
    h1 {
        font-size: 1.5em;
    }
    
    ol {
        border: 1px solid #ccc;
        padding-left: 35px;
        padding-right: 35px;
        padding-top: 15px;
        padding-bottom: 10px;
    }
    
    ol>li {
        margin-bottom: 0.5em;
    }
    
    h5 {
        margin-top: -10px;
    }
</style>